(swan.webpackJsonp=swan.webpackJsonp||[]).push([[77],{"161":function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{"value":!0});var D=Object.assign||function(e){for(var n=1;n<arguments.length;n++){var t=arguments[n];for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a])}return e},a=function(e,n,t){return n&&defineProperties(e.prototype,n),t&&defineProperties(e,t),e};function defineProperties(e,n){for(var t=0;t<n.length;t++){var a=n[t];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}var E=_interopRequireDefault(t(0)),R=t(1),k=_interopRequireDefault(t(162)),w=_interopRequireDefault(t(15)),P=t(8),M=_interopRequireDefault(t(4)),J=t(3),U=t(25);function _interopRequireDefault(e){return e&&e.__esModule?e:{"default":e}}t(163);var r=(function _inherits(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function, not "+typeof n);e.prototype=Object.create(n&&n.prototype,{"constructor":{"value":e,"enumerable":!1,"writable":!0,"configurable":!0}}),n&&(Object.setPrototypeOf?Object.setPrototypeOf(e,n):e.__proto__=n)}(RealName,E.default.Component),a(RealName,[{"key":"_constructor","value":function _constructor(e){(function get(e,n,t){null===e&&(e=Function.prototype);var a=Object.getOwnPropertyDescriptor(e,n);if(void 0===a){var r=Object.getPrototypeOf(e);return null===r?void 0:get(r,n,t)}if("value"in a)return a.value;var u=a.get;return void 0!==u?u.call(t):void 0})(RealName.prototype.__proto__||Object.getPrototypeOf(RealName.prototype),"_constructor",this).call(this,e),this.$$refs=new E.default.RefsArray}},{"key":"_createData","value":function _createData(e,n,t){this.__state=e||this.state||{},this.__props=n||this.props||{},this.$prefix;var a=(0,J.useDispatch)(),r=(0,k.default)(),u=r.checkDegree,o=r.userUploadIdcard,i=r.sexArray,s=r.sexCurrent,c=r.setSexCurrent,d=r.setSexName,m=r.sexName,l=r.nationCurrent,f=r.initModel,y=r.setNationCurrent,h=r.setInitModel,p=r.model,g=r.setModel,_=r.userPostAuthInfo,b=r.RealnameArea,v=(0,w.default)(),x=v.text,F=v.userGetCode;function wa(e,n){var t=JSON.parse(JSON.stringify(p));t[e]=n.detail.value,g(t)}function xa(e){o(e)}a((0,U.setAddressFun)(function setRealnameAddress(e){g(D({},p,{"address":e}))}));var A=new Date,C=A.getFullYear(),N=A.getMonth()+1,I=A.getDate(),O=C-60+"-"+N+"-"+I,S=C-18+"-"+N+"-"+I;return this.anonymousFunc0=function(){return xa(1)},this.anonymousFunc1=function(){return xa(2)},this.anonymousFunc2=function(e){return wa("username",e)},this.anonymousFunc3=function(e){return function userChangeSex(e){var n=parseInt(e.detail.value),t=i[n].id;c(n),d(i[n].name),p&&g(D({},p,{"gender":t}))}(e)},this.anonymousFunc4=function(e){return function userChangeBirthday(e){var n=e.detail.value;if(f){var t=JSON.parse(JSON.stringify(f.memberExt));t.birthday=n,h(D({},f,{"memberExt":t})),p&&g(D({},p,{"birthday":n}))}}(e)},this.anonymousFunc5=function(e){return function userChangeNation(e){var n=parseInt(e.detail.value);if(y(n),f){var t=f.nation[n].mz_name,a=f.nation[n].mz_id;p&&g(D({},p,{"nation_id":a,"nationality":t}))}}(e)},this.anonymousFunc6=function(e){return wa("idCard",e)},this.anonymousFunc7=function(){return function userChooseArea(){b&&E.default.navigateTo({"url":"/pages/map/realname/index"})}()},this.anonymousFunc8=function(e){return function userEnterAddress(e){p&&g(D({},p,{"address":e.detail.value}))}(e)},this.anonymousFunc9=function(e){return wa("tel",e)},this.anonymousFunc10=function(e){return wa("code",e)},this.anonymousFunc11=function(){return function userSendCode(){var e=f&&f.member?f.member.tel:"";(0,P.isPhone)(e)?F(e):(0,M.default)("请先输入正确的手机号")}()},this.anonymousFunc12=function(){return _()},Object.assign(this.__state,{"initModel":f,"ALIYUNCDN":R.ALIYUNCDN,"IMGCDNURL":R.IMGCDNURL,"model":p,"sexCurrent":s,"sexArray":i,"sexName":m,"startDate":O,"endDate":S,"nationCurrent":l,"USEGAODEMAPAPI":R.USEGAODEMAPAPI,"checkDegree":u,"text":x}),this.__state}},{"key":"anonymousFunc0","value":function anonymousFunc0(){}},{"key":"anonymousFunc1","value":function anonymousFunc1(){}},{"key":"anonymousFunc2","value":function anonymousFunc2(){}},{"key":"anonymousFunc3","value":function anonymousFunc3(){}},{"key":"anonymousFunc4","value":function anonymousFunc4(){}},{"key":"anonymousFunc5","value":function anonymousFunc5(){}},{"key":"anonymousFunc6","value":function anonymousFunc6(){}},{"key":"anonymousFunc7","value":function anonymousFunc7(){}},{"key":"anonymousFunc8","value":function anonymousFunc8(){}},{"key":"anonymousFunc9","value":function anonymousFunc9(){}},{"key":"anonymousFunc10","value":function anonymousFunc10(){}},{"key":"anonymousFunc11","value":function anonymousFunc11(){}},{"key":"anonymousFunc12","value":function anonymousFunc12(){}}]),RealName);function RealName(){!function _classCallCheck(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}(this,RealName);var e=function _possibleConstructorReturn(e,n){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!n||"object"!=typeof n&&"function"!=typeof n?e:n}(this,(RealName.__proto__||Object.getPrototypeOf(RealName)).apply(this,arguments));return e.config={"navigationBarTitleText":"鱼泡网-实名认证"},e.$usedState=["initModel","ALIYUNCDN","IMGCDNURL","model","sexCurrent","sexArray","sexName","startDate","endDate","nationCurrent","USEGAODEMAPAPI","checkDegree","text"],e.customComponents=["Auth"],e}r.$$events=["anonymousFunc0","anonymousFunc1","anonymousFunc2","anonymousFunc3","anonymousFunc4","anonymousFunc5","anonymousFunc6","anonymousFunc7","anonymousFunc8","anonymousFunc9","anonymousFunc10","anonymousFunc11","anonymousFunc12"],r.$$componentPath="pages/realname/index",r.config={"navigationBarTitleText":"鱼泡网-实名认证"},n.default=r,Page(t(0).default.createComponent(r,!0))},"162":function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{"value":!0});var P=Object.assign||function(e){for(var n=1;n<arguments.length;n++){var t=arguments[n];for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a])}return e},M=function(e,n){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function sliceIterator(e,n){var t=[],a=!0,r=!1,u=void 0;try{for(var o,i=e[Symbol.iterator]();!(a=(o=i.next()).done)&&(t.push(o.value),!n||t.length!==n);a=!0);}catch(e){r=!0,u=e}finally{try{!a&&i.return&&i.return()}finally{if(r)throw u}}return t}(e,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")};n.default=function useRealname(){var c=(0,H.useDispatch)(),e=(0,J.useState)(0),n=M(e,2),a=n[0],d=n[1],t=(0,J.useState)(""),r=M(t,2),u=r[0],m=r[1],o=(0,J.useState)(0),i=M(o,2),s=i[0],l=i[1],f=(0,J.useState)({}),y=M(f,2),h=y[0],p=y[1],g=(0,J.useState)({"username":"","age":"","nation_id":"","nationality":"","idCard":"","idCardImg":"","handImg":"","tel":"","code":"","address":"","birthday":"","gender":""}),_=M(g,2),b=_[0],v=_[1],x=(0,H.useSelector)(function(e){return e.User.login}),F=(0,J.useState)(!1),A=M(F,2),C=A[0],N=A[1],I=(0,J.useState)(!1),O=M(I,2),S=O[0],D=O[1],E=(0,J.useState)(""),R=M(E,2),k=R[0],w=R[1];(0,J.useEffect)(function(){x&&(0,j.getUserAuthInfo)().then(function(e){if("ok"==e.errcode){e.authData.member&&"0"===e.authData.member.is_check&&U.default.showModal({"title":"审核失败","content":e.authData.memberExt.idcard_check_failure_reason,"showCancel":!1});var n=e.authData;p(n);var t=n.memberExt.nation_id||"",a="",r=0;t&&(r=n.nation.findIndex(function(e){return e.mz_id==t}),a=n.nation[r].mz_name),l(r);var u={"username":n.member?n.member.username:"","age":n.memberExt.age||"","nation_id":t||n.nation[r].mz_id,"nationality":a||n.nation[r].mz_name,"idCard":n.memberExt.id_card||"","idCardImg":n.memberExt.id_card_img||"","handImg":n.memberExt.hand_img||"","tel":n.member?n.member.tel:"","code":"","address":n.memberExt.address||"","birthday":n.memberExt.birthday||"","gender":n.memberExt.sex||""},o=(0,B.getLongAreaAdname)(u.address);w(o);var i={"RealnameArea":o,"setRealnameArea":function setRealnameArea(e){return w(e)},"setRealnameAddress":function setRealnameAddress(){}};if(c((0,K.setData)(i)),n.member&&"2"==n.member.check_degree&&D(!0),""!==n.memberExt.sex)for(var s=0;s<V.length;s++)if(V[s].id==n.memberExt.sex){m(V[s].name),d(s);break}v(P({},u)),n.member&&"2"==n.member.check_degree&&N(!0)}else(0,q.ShowActionModal)({"msg":e.errmsg,"success":function success(){U.default.navigateBack()}})})},[x]);return{"initModel":h,"model":b,"setModel":v,"login":x,"userPostAuthInfo":function userPostAuthInfo(){if(function vaildUserAuthInfo(){return!(!b||!h)&&(b.idCardImg?b.handImg?b.username?b.gender?b.birthday?b.nation_id?b.idCard?b.address?!$.USEGAODEMAPAPI&&b.address.length<5?((0,G.default)("地址最少5个字"),!1):b.tel?!!h.member&&(!(!h.member.tel&&!b.code)||((0,G.default)("请输入验证码"),!1)):((0,G.default)("请输入您的手机号"),!1):((0,G.default)("请选择您的地址"),!1):((0,G.default)("请输入您的身份证号码"),!1):((0,G.default)("请选择您的民族"),!1):((0,G.default)("请选择您的出生日期"),!1):((0,G.default)("请选择您的性别"),!1):((0,G.default)("请输入您的名字"),!1):((0,G.default)("请上传身份手持照"),!1):((0,G.default)("请上传身份证照片"),!1))}()){var e=JSON.parse(JSON.stringify(b)),n=JSON.parse(JSON.stringify(h)),t={"username":e.username,"age":e.age,"nation_id":n.nation[s].mz_id,"nationality":n.nation[s].mz_name,"idCard":e.idCard,"idCardImg":e.idCardImg,"handImg":e.handImg,"tel":e.tel,"code":e.code,"address":e.address,"birthday":n.memberExt.birthday,"gender":a+1};(0,j.postUserAuthInfo)(t).then(function(e){(0,Y.SubscribeToNews)("auth",function(){(0,q.ShowActionModal)({"msg":e.errmsg,"success":function success(){U.default.navigateBack()}})})})}},"userUploadIdcard":function userUploadIdcard(e){var n=0<arguments.length&&void 0!==e?e:2,i=JSON.parse(JSON.stringify(b)),t=1==n?L.getIdcardAuthInfo:"";if(h)if(1===n)(0,T.CameraAndAlbum)(t).then(function(e){if("ok"==e.errcode){var t=JSON.parse(JSON.stringify(h.memberExt));if(e.card_info){N(!0),t.id_card_img=e.url,t.id_card_img_path=e.httpurl,p(P({},h,{"memberExt":P({},t)}));var n=e.card_info;if(e.card_info.success){t.nation_id=n.nation_id||"",t.nationality=n.nationality||"",t.birthday=n.birth||"",t.address=n.address||"",t.sex=n.sex||"",t.id_card=n.num||"",t.user_name=n.name||"";var a="";if(t.birthday)a=t.birthday.substring(0,4)+"-"+t.birthday.substring(4,6)+"-"+t.birthday.substring(6,8);var r=0,u="";V.map(function(e,n){t.sex===e.name&&(r=n,u=e.id)}),d(r),m(t.sex);var o={"username":t.user_name?t.user_name:"","age":t.age||"","nation_id":t.nation_id,"nationality":t.nationality,"idCard":t.id_card||"","idCardImg":t.id_card_img||"","handImg":t.hand_img||"","tel":i.tel||"","code":"","address":t.address,"birthday":a||"","gender":u};t.birthday=a,p(P({},h,{"memberExt":P({},t)})),v(P({},o))}else(0,G.default)(e.card_info.tips_message),t.id_card_img_path=Q,t.id_card_img=Q,b&&v(P({},b,{"idCardImg":e.url})),p(P({},h,{"memberExt":P({},t)}))}}else(0,G.default)(e.errmsg)});else{var a=JSON.parse(JSON.stringify(h.memberExt));(0,z.default)().then(function(e){var n={"url":e.url,"httpurl":e.httpurl};a.hand_img=n.url,a.hand_img_path=n.httpurl;var t=JSON.parse(JSON.stringify(b));t.handImg=n.url,v(t)}),p(P({},h,{"memberExt":a}))}},"sexArray":V,"setSexCurrent":d,"sexCurrent":a,"showForm":C,"sexName":u,"setSexName":m,"nationCurrent":s,"setNationCurrent":l,"setInitModel":p,"checkDegree":S,"RealnameArea":k,"setRealnameArea":w}};var J=t(0),U=_interopRequireDefault(J),j=t(2),q=t(4),G=_interopRequireDefault(q),T=t(13),z=_interopRequireDefault(T),L=t(46),$=t(1),B=t(9),Y=t(17),H=t(3),K=t(25);function _interopRequireDefault(e){return e&&e.__esModule?e:{"default":e}}var Q=$.ALIYUNCDNMINIIMG+"lpy/auth/upload-fail-tips.png",V=[{"id":"1","name":"男"},{"id":"2","name":"女"}]},"163":function(e,n,t){}},[[161,0,1]]]);