(tt.webpackJsonp=tt.webpackJsonp||[]).push([[69],{"126":function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{"value":!0});var R=Object.assign||function(e){for(var n=1;n<arguments.length;n++){var t=arguments[n];for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a])}return e},a=function(e,n,t){return n&&defineProperties(e.prototype,n),t&&defineProperties(e,t),e};function defineProperties(e,n){for(var t=0;t<n.length;t++){var a=n[t];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}var k=t(0),E=_interopRequireDefault(k),w=t(2),M=_interopRequireDefault(t(127)),P=_interopRequireDefault(t(12)),J=t(6),j=t(3),U=t(128),T=_interopRequireDefault(t(4));function _interopRequireDefault(e){return e&&e.__esModule?e:{"default":e}}t(129);var r=(function _inherits(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function, not "+typeof n);e.prototype=Object.create(n&&n.prototype,{"constructor":{"value":e,"enumerable":!1,"writable":!0,"configurable":!0}}),n&&(Object.setPrototypeOf?Object.setPrototypeOf(e,n):e.__proto__=n)}(RealName,E.default.Component),a(RealName,[{"key":"_constructor","value":function _constructor(e){(function get(e,n,t){null===e&&(e=Function.prototype);var a=Object.getOwnPropertyDescriptor(e,n);if(void 0===a){var r=Object.getPrototypeOf(e);return null===r?void 0:get(r,n,t)}if("value"in a)return a.value;var o=a.get;return void 0!==o?o.call(t):void 0})(RealName.prototype.__proto__||Object.getPrototypeOf(RealName.prototype),"_constructor",this).call(this,e),this.$$refs=new E.default.RefsArray}},{"key":"_createData","value":function _createData(e,n,t){this.__state=e||this.state||{},this.__props=n||this.props||{},this.$prefix;var a=(0,M.default)(),r=a.checkDegree,o=a.userUploadIdcard,u=a.sexArray,i=a.sexCurrent,s=a.setSexCurrent,c=a.setSexName,d=a.sexName,m=a.nationCurrent,l=a.initModel,f=a.setNationCurrent,y=a.setInitModel,h=a.model,p=a.setModel,g=a.userPostAuthInfo,_=a.RealnameArea,b=a.setRealnameArea,v=(0,P.default)(),x=v.text,F=v.userGetCode,N={"RealnameArea":_,"setRealnameArea":function setRealnameArea(e){return b(e)}};(0,j.useDispatch)()((0,U.setData)(N));var C=new Date,S=C.getFullYear(),O=C.getMonth()+1,D=C.getDate(),I=S-60+"-"+O+"-"+D,A=S-18+"-"+O+"-"+D;function xa(e,n){var t=JSON.parse(JSON.stringify(h));t[e]=n.detail.value,p(t)}function ya(e){o(e)}return(0,k.useDidShow)(function(){if(_){var e=JSON.parse(JSON.stringify(h));e.address=_,p(e)}}),this.anonymousFunc0=function(){return ya(1)},this.anonymousFunc1=function(){return ya(2)},this.anonymousFunc2=function(e){return xa("username",e)},this.anonymousFunc3=function(e){return function userChangeSex(e){var n=parseInt(e.detail.value),t=u[n].id;s(n),c(u[n].name),h&&p(R({},h,{"gender":t}))}(e)},this.anonymousFunc4=function(e){return function userChangeBirthday(e){var n=e.detail.value;if(l){var t=JSON.parse(JSON.stringify(l.memberExt));t.birthday=n,y(R({},l,{"memberExt":t})),h&&p(R({},h,{"birthday":n}))}}(e)},this.anonymousFunc5=function(e){return function userChangeNation(e){var n=parseInt(e.detail.value);if(f(n),l){var t=l.nation[n].mz_name,a=l.nation[n].mz_id;h&&p(R({},h,{"nation_id":a,"nationality":t}))}}(e)},this.anonymousFunc6=function(e){return xa("idCard",e)},this.anonymousFunc7=function(){return function userChooseArea(){_&&E.default.navigateTo({"url":"/pages/map/realname/index"})}()},this.anonymousFunc8=function(e){return xa("tel",e)},this.anonymousFunc9=function(e){return xa("code",e)},this.anonymousFunc10=function(){return function userSendCode(){var e=l&&l.member?l.member.tel:"";(0,J.isPhone)(e)?F(e):(0,T.default)("请先输入正确的手机号")}()},this.anonymousFunc11=function(){return g()},Object.assign(this.__state,{"initModel":l,"ALIYUNCDN":w.ALIYUNCDN,"IMGCDNURL":w.IMGCDNURL,"model":h,"sexCurrent":i,"sexArray":u,"sexName":d,"startDate":I,"endDate":A,"nationCurrent":m,"checkDegree":r,"text":x}),this.__state}},{"key":"anonymousFunc0","value":function anonymousFunc0(){}},{"key":"anonymousFunc1","value":function anonymousFunc1(){}},{"key":"anonymousFunc2","value":function anonymousFunc2(){}},{"key":"anonymousFunc3","value":function anonymousFunc3(){}},{"key":"anonymousFunc4","value":function anonymousFunc4(){}},{"key":"anonymousFunc5","value":function anonymousFunc5(){}},{"key":"anonymousFunc6","value":function anonymousFunc6(){}},{"key":"anonymousFunc7","value":function anonymousFunc7(){}},{"key":"anonymousFunc8","value":function anonymousFunc8(){}},{"key":"anonymousFunc9","value":function anonymousFunc9(){}},{"key":"anonymousFunc10","value":function anonymousFunc10(){}},{"key":"anonymousFunc11","value":function anonymousFunc11(){}}]),RealName);function RealName(){!function _classCallCheck(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}(this,RealName);var e=function _possibleConstructorReturn(e,n){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!n||"object"!=typeof n&&"function"!=typeof n?e:n}(this,(RealName.__proto__||Object.getPrototypeOf(RealName)).apply(this,arguments));return e.config={"navigationBarTitleText":"鱼泡网-实名认证"},e.$usedState=["initModel","ALIYUNCDN","IMGCDNURL","model","sexCurrent","sexArray","sexName","startDate","endDate","nationCurrent","checkDegree","text"],e.customComponents=[],e}r.$$events=["anonymousFunc0","anonymousFunc1","anonymousFunc2","anonymousFunc3","anonymousFunc4","anonymousFunc5","anonymousFunc6","anonymousFunc7","anonymousFunc8","anonymousFunc9","anonymousFunc10","anonymousFunc11"],r.$$componentPath="pages/realname/index",r.config={"navigationBarTitleText":"鱼泡网-实名认证"},n.default=r,Page(t(0).default.createComponent(r,!0))},"127":function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{"value":!0});var w=Object.assign||function(e){for(var n=1;n<arguments.length;n++){var t=arguments[n];for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a])}return e},M=function(e,n){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function sliceIterator(e,n){var t=[],a=!0,r=!1,o=void 0;try{for(var u,i=e[Symbol.iterator]();!(a=(u=i.next()).done)&&(t.push(u.value),!n||t.length!==n);a=!0);}catch(e){r=!0,o=e}finally{try{!a&&i.return&&i.return()}finally{if(r)throw o}}return t}(e,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")};n.default=function useRealname(){var e=(0,P.useState)(0),n=M(e,2),a=n[0],s=n[1],t=(0,P.useState)(""),r=M(t,2),o=r[0],c=r[1],u=(0,P.useState)(0),i=M(u,2),d=i[0],m=i[1],l=(0,P.useState)(),f=M(l,2),y=f[0],h=f[1],p=(0,P.useState)(),g=M(p,2),_=g[0],b=g[1],v=(0,U.useSelector)(function(e){return e.User.login}),x=(0,P.useState)(!1),F=M(x,2),N=F[0],C=F[1],S=(0,P.useState)(!1),O=M(S,2),D=O[0],I=O[1],A=(0,P.useState)(""),R=M(A,2),k=R[0],E=R[1];(0,P.useEffect)(function(){v&&(0,j.getUserAuthInfo)().then(function(e){if("ok"==e.errcode){e.authData.member&&"0"===e.authData.member.is_check&&J.default.showModal({"title":"审核失败","content":e.authData.memberExt.idcard_check_failure_reason,"showCancel":!1});var n=e.authData;h(n);var t=n.memberExt.nation_id||"",a="",r=0;t&&(r=n.nation.findIndex(function(e){return e.mz_id==t}),a=n.nation[r].mz_name),m(r);var o={"username":n.member?n.member.username:"","age":n.memberExt.age||"","nation_id":t||n.nation[r].mz_id,"nationality":a||n.nation[r].mz_name,"idCard":n.memberExt.id_card||"","idCardImg":n.memberExt.id_card_img||"","handImg":n.memberExt.hand_img||"","tel":n.member?n.member.tel:"","code":"","address":n.memberExt.address||"","birthday":n.memberExt.birthday||"","gender":n.memberExt.sex||""};console.log(o);var u=(0,G.getLongAreaAdname)(o.address);if(E(u),n.member&&"2"==n.member.check_degree&&I(!0),""!==n.memberExt.sex)for(var i=0;i<H.length;i++)if(H[i].id==n.memberExt.sex){c(H[i].name),s(i);break}b(w({},o)),n.member&&"2"==n.member.check_degree&&C(!0)}else(0,T.ShowActionModal)({"msg":e.errmsg,"success":function success(){J.default.navigateBack()}})})},[v]);return{"initModel":y,"model":_,"setModel":b,"login":v,"userPostAuthInfo":function userPostAuthInfo(){if(console.log(_),console.log(y),function vaildUserAuthInfo(){return!(!_||!y)&&(_.idCardImg?_.handImg?_.username?_.gender?_.birthday?_.nation_id?_.idCard?_.address?_.tel?!!y.member&&(!(!y.member.tel&&!_.code)||((0,q.default)("请输入验证码"),!1)):((0,q.default)("请输入您的手机号"),!1):((0,q.default)("请选择您的地址"),!1):((0,q.default)("请输入您的身份证号码"),!1):((0,q.default)("请选择您的民族"),!1):((0,q.default)("请选择您的出生日期"),!1):((0,q.default)("请选择您的性别"),!1):((0,q.default)("请输入您的名字"),!1):((0,q.default)("请上传身份手持照"),!1):((0,q.default)("请上传身份证照片"),!1))}()){var e=JSON.parse(JSON.stringify(_)),n=JSON.parse(JSON.stringify(y)),t={"username":e.username,"age":e.age,"nation_id":n.nation[d].mz_id,"nationality":n.nation[d].mz_name,"idCard":e.idCard,"idCardImg":e.idCardImg,"handImg":e.handImg,"tel":e.tel,"code":e.code,"address":e.address,"birthday":n.memberExt.birthday,"gender":a+1};(0,j.postUserAuthInfo)(t).then(function(e){console.log(e),(0,B.SubscribeToNews)("auth",function(){(0,T.ShowActionModal)({"msg":e.errmsg,"success":function success(){J.default.navigateBack()}})})})}},"userUploadIdcard":function userUploadIdcard(e){var n=0<arguments.length&&void 0!==e?e:2,u=JSON.parse(JSON.stringify(_)),t=1==n?$.getIdcardAuthInfo:"";if(y)if(1===n)(0,z.CameraAndAlbum)(t).then(function(e){if("ok"==e.errcode){var t=JSON.parse(JSON.stringify(y.memberExt));if(e.card_info){C(!0),t.id_card_img=e.url,t.id_card_img_path=e.httpurl,h(w({},y,{"memberExt":w({},t)}));var n=e.card_info;if(e.card_info.success){t.nation_id=n.nation_id||"",t.nationality=n.nationality||"",t.birthday=n.birth||"",t.address=n.address||"",t.sex=n.sex||"",t.id_card=n.num||"",t.user_name=n.name||"";var a="";if(t.birthday)a=t.birthday.substring(0,4)+"-"+t.birthday.substring(4,6)+"-"+t.birthday.substring(6,8);var r=0;H.map(function(e,n){t.sex===e.name&&(r=n)}),s(r),c(t.sex);var o={"username":t.user_name?t.user_name:"","age":t.age||"","nation_id":t.nation_id,"nationality":t.nationality,"idCard":t.id_card||"","idCardImg":t.id_card_img||"","handImg":t.hand_img||"","tel":u.tel||"","code":"","address":t.address,"birthday":a||"","gender":r&&-1!=r?r:""};t.birthday=a,h(w({},y,{"memberExt":w({},t)})),b(o)}else(0,q.default)(e.card_info.tips_message),t.id_card_img_path=Y,t.id_card_img=Y,_&&b(w({},_,{"idCardImg":e.url})),h(w({},y,{"memberExt":w({},t)}))}}else(0,q.default)(e.errmsg)});else{var a=JSON.parse(JSON.stringify(y.memberExt));(0,L.default)().then(function(e){var n={"url":e.url,"httpurl":e.httpurl};console.log(n),a.hand_img=n.url,a.hand_img_path=n.httpurl;var t=JSON.parse(JSON.stringify(_));t.handImg=n.url,b(t)}),h(w({},y,{"memberExt":a}))}},"sexArray":H,"setSexCurrent":s,"sexCurrent":a,"showForm":N,"sexName":o,"setSexName":c,"nationCurrent":d,"setNationCurrent":m,"setInitModel":h,"checkDegree":D,"RealnameArea":k,"setRealnameArea":E}};var P=t(0),J=_interopRequireDefault(P),j=t(1),U=t(3),T=t(4),q=_interopRequireDefault(T),z=t(15),L=_interopRequireDefault(z),$=t(34),a=t(2),G=t(8),B=t(14);function _interopRequireDefault(e){return e&&e.__esModule?e:{"default":e}}var Y=a.ALIYUNCDNMINIIMG+"lpy/auth/upload-fail-tips.png",H=[{"id":"1","name":"男"},{"id":"2","name":"女"}]},"128":function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{"value":!0}),n.setData=function setData(e){return{"type":a.SET,"data":e}},n.getData=function getData(){return{"type":a.GET}},n.setArea=function setArea(e){return{"type":a.SETAREA,"data":e}},n.setFun=function setFun(e){return{"type":a.SETFUN,"data":e}};var a=t(30)},"129":function(e,n,t){}},[[126,0,1]]]);