(tt.webpackJsonp=tt.webpackJsonp||[]).push([[72],{"100":function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{"value":!0});var O=Object.assign||function(e){for(var n=1;n<arguments.length;n++){var t=arguments[n];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},C=function(e,n){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function sliceIterator(e,n){var t=[],o=!0,i=!1,r=void 0;try{for(var u,a=e[Symbol.iterator]();!(o=(u=a.next()).done)&&(t.push(u.value),!n||t.length!==n);o=!0);}catch(e){i=!0,r=e}finally{try{!o&&a.return&&a.return()}finally{if(i)throw r}}return t}(e,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")};n.default=function usePublishViewInfo(o){var e=(0,U.useSelector)(function(e){return e.User.login}),n=(0,R.useState)(),t=C(n,2),i=t[0],r=t[1],u=(0,R.useState)(!1),a=C(u,2),s=a[0],c=a[1],l=(0,R.useState)(!1),f=C(l,2),d=f[0],m=f[1],y=(0,R.useState)(0),p=C(y,2),h=p[0],_=p[1],v=(0,R.useState)(""),g=C(v,2),b=g[0],w=g[1],P=(0,R.useState)({}),F=C(P,2),S=F[0],k=F[1],I=(0,U.useSelector)(function(e){return e.MyAreaInfo}),A=(0,U.useDispatch)();return(0,R.useEffect)(function(){e&&(0,T.getPublishRecruitView)(o).then(function(e){if("ok"==e.errcode){var n={"placeholder":e.placeholder,"classifies":e.selectedClassifies,"maxImageCount":e.typeTextArr.maxImageCount,"maxClassifyCount":e.typeTextArr.maxClassifyCount,"classifyTree":e.classifyTree,"title":e.model.title||"","address":e.model.address||"","detail":e.model.detail||"","infoId":e.model.id||o.infoId,"type":e.type,"user_mobile":e.model.user_mobile||e.memberInfo.tel||"","code":"","user_name":e.model.user_name,"view_images":e.view_image,"province_id":e.model.province_id||"","city_id":e.model.city_id||"","location":e.model.location||"","adcode":"","county_id":e.model.county_id||"","is_check":e.model.hasOwnProperty("is_check")?e.model.is_check:1,"check_fail_msg":e.model.check_fail_msg||""};r(n),function initUserAreaInfo(e){if(console.log(o.infoId,"InitParams.infoId"),o.infoId)A((0,q.setArea)(e.default_search_name.name));else{var n=x.default.getStorageSync(j.UserLocationCity);n?A((0,q.setArea)(n.city)):(0,$.userAuthLoction)().then(function(e){A((0,q.setArea)(e.city))}).catch(function(){A((0,q.setArea)(M.AREABEIJING.name))})}if(o.infoId)A((0,q.setAreaInfo)({"title":e.model.address,"location":e.model.location,"info":"","adcode":e.model.adcode||""}));else{var t=x.default.getStorageSync(j.UserLastPublishArea);t&&A((0,q.setAreaInfo)(t))}}(e),0==n.is_check&&function bakModelInfo(e){var n={"title":e.title,"address":e.address,"detail":e.detail,"infoId":e.infoId,"type":e.type,"user_mobile":e.user_mobile,"code":e.code,"user_name":e.user_name,"province_id":e.province_id,"city_id":e.city_id,"location":e.location,"adcode":"","county_id":e.county_id,"classifies":e.classifies,"images":e.view_images.map(function(e){return e.url})};k(n),(0,D.ShowActionModal)({"title":"审核失败","msg":e.check_fail_msg})}(n),A((0,q.setAreaInfo)(O({},I,{"title":n.address}))),w(n.user_mobile),e.view_image.length&&c(!0),n.detail&&_(n.detail.length)}else(0,D.ShowActionModal)({"msg":e.errmsg,"success":function success(){x.default.navigateBack()}})})},[e]),{"model":i,"setModel":r,"showUpload":s,"setShowUpload":c,"showProfession":d,"setShowProssion":m,"userPublishRecruitAction":function userPublishRecruitAction(){var e=function getPublishedInfo(){if(!i)return;return{"title":i.title,"address":I.title,"detail":i.detail,"infoId":i.infoId,"type":i.type,"user_mobile":i.user_mobile,"code":i.code,"user_name":i.user_name,"province_id":i.province_id,"city_id":i.city_id,"location":i.location,"adcode":I.adcode,"county_id":i.county_id,"classifies":i.classifies,"images":i.view_images.map(function(e){return e.url})}}();if(!e)return;if(!(0,B.isVaildVal)(e.title,3))return void(0,N.default)("请正确输入3~12字中文标题!");if(!e.classifies.length)return void(0,N.default)("请选择您的工种!");if(!e.province_id&&!e.address)return void(0,N.default)("请选择您的详细地址!");if(!(0,B.isVaildVal)(e.user_name,2))return void(0,N.default)("请正确输入2~6字中文姓名!");if(!(0,B.isPhone)(e.user_mobile))return void(0,N.default)("手机号输入有误!");if(b!=e.user_mobile&&!e.code)return void(0,N.default)("请输入正确的验证码!");if(!(0,B.isVaildVal)(e.detail,15))return void(0,N.default)("请正确输入15~500字招工详情!");if(i&&0==i.is_check){var n=JSON.stringify(S),t=JSON.stringify(e);if(n==t)return void(0,D.ShowActionModal)({"title":"审核失败","msg":i&&i.check_fail_msg})}e.address+="@@@@@"+I.info,(0,T.publishRecruitInfo)(e).then(function(e){"ok"==e.errcode?(0,J.SubscribeToNews)("recruit",function(){(0,D.ShowActionModal)({"msg":e.errmsg,"success":function success(){x.default.reLaunch({"url":"/pages/published/recruit/index"})}})}):(0,D.ShowActionModal)({"msg":e.errmsg})})},"num":h,"setNum":_,"phone":b}};var R=t(0),x=_interopRequireDefault(R),T=t(1),j=t(7),M=t(8),$=t(9),D=t(4),N=_interopRequireDefault(D),J=t(14),U=t(3),B=t(6),q=t(19);function _interopRequireDefault(e){return e&&e.__esModule?e:{"default":e}}},"103":function(e,n,t){},"99":function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{"value":!0});var T=Object.assign||function(e){for(var n=1;n<arguments.length;n++){var t=arguments[n];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},j=function(e,n){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function sliceIterator(e,n){var t=[],o=!0,i=!1,r=void 0;try{for(var u,a=e[Symbol.iterator]();!(o=(u=a.next()).done)&&(t.push(u.value),!n||t.length!==n);o=!0);}catch(e){i=!0,r=e}finally{try{!o&&a.return&&a.return()}finally{if(i)throw r}}return t}(e,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")},o=function(e,n,t){return n&&defineProperties(e.prototype,n),t&&defineProperties(e,t),e};function defineProperties(e,n){for(var t=0;t<n.length;t++){var o=n[t];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}var M=t(0),$=_interopRequireDefault(M),D=_interopRequireDefault(t(12)),N=_interopRequireDefault(t(100)),J=_interopRequireDefault(t(15)),U=_interopRequireDefault(t(4));t(103);var B=t(3);function _interopRequireDefault(e){return e&&e.__esModule?e:{"default":e}}function _toConsumableArray(e){if(Array.isArray(e)){for(var n=0,t=Array(e.length);n<e.length;n++)t[n]=e[n];return t}return Array.from(e)}var i=(function _inherits(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function, not "+typeof n);e.prototype=Object.create(n&&n.prototype,{"constructor":{"value":e,"enumerable":!1,"writable":!0,"configurable":!0}}),n&&(Object.setPrototypeOf?Object.setPrototypeOf(e,n):e.__proto__=n)}(PublishRecruit,$.default.Component),o(PublishRecruit,[{"key":"_constructor","value":function _constructor(e){(function get(e,n,t){null===e&&(e=Function.prototype);var o=Object.getOwnPropertyDescriptor(e,n);if(void 0===o){var i=Object.getPrototypeOf(e);return null===i?void 0:get(i,n,t)}if("value"in o)return o.value;var r=o.get;return void 0!==r?r.call(t):void 0})(PublishRecruit.prototype.__proto__||Object.getPrototypeOf(PublishRecruit.prototype),"_constructor",this).call(this,e),this.$$refs=new $.default.RefsArray}},{"key":"_createData","value":function _createData(e,n,t){function pc(e,n){var t=e.detail.value,o=JSON.parse(JSON.stringify(g));o[n]=t,b(o),"detail"===n&&A(t.length)}this.__state=e||this.state||{},this.__props=n||this.props||{};var o=this.$prefix,i=(0,M.genCompid)(o+"$compid__30"),r=j(i,2),u=r[0],a=r[1],s=(0,M.genCompid)(o+"$compid__31"),c=j(s,2),l=c[0],f=c[1],d=(0,M.genCompid)(o+"$compid__32"),m=j(d,2),y=m[0],p=m[1],h={"type":"job","infoId":(0,M.useRouter)().params.id||""},_=(0,B.useSelector)(function(e){return e.MyAreaInfo}),v=(0,N.default)(h),g=v.model,b=v.setModel,w=v.showUpload,P=v.setShowUpload,F=v.showProfession,S=v.setShowProssion,k=v.userPublishRecruitAction,I=v.num,A=v.setNum,O=v.phone,C=(0,D.default)(),R=C.text,x=C.userGetCode;return this.anonymousFunc0=function(e,n,t){return function userClickProfession(e,n,t){if(g){var o=JSON.parse(JSON.stringify(g.classifyTree)),i=o[e].children[n].is_check;if(!i){var r=g.maxClassifyCount;if(r<=g.classifies.length)return void(0,U.default)("工种最多可以选择"+r+"个")}o[e].children[n].is_check=!i;var u=JSON.parse(JSON.stringify(g.classifies)),a=i?u.filter(function(e){return e!==t}):[].concat(_toConsumableArray(u),[t]);b(T({},g,{"classifyTree":o,"classifies":a}))}}(e,n,t)},this.anonymousFunc1=function(e){return pc(e,"title")},this.anonymousFunc2=function(){return function showProfessionAction(){S(!0)}()},this.anonymousFunc3=function(){return function userChooseArea(){g&&$.default.navigateTo({"url":"/pages/map/recruit/index"})}()},this.anonymousFunc4=function(e){return pc(e,"user_name")},this.anonymousFunc5=function(e){return pc(e,"user_mobile")},this.anonymousFunc6=function(e){return pc(e,"code")},this.anonymousFunc7=function(){return x(g.user_mobile)},this.anonymousFunc8=function(e){return pc(e,"detail")},this.anonymousFunc9=function(){return function changeShowUpload(){P(!w)}()},this.anonymousFunc10=function(){return k()},F&&M.propsManager.set({"closeProfession":function closeProfession(){S(!1)},"data":g&&g.classifyTree,"onClickItem":this.anonymousFunc0,"num":3},a,u),M.propsManager.set({"num":I},f,l),w&&g&&M.propsManager.set({"images":g.view_images,"max":g.maxImageCount,"userUploadImg":function userUploadImg(e){var t=0<arguments.length&&void 0!==e?e:-1;(0,J.default)().then(function(e){var n={"url":e.url,"httpurl":e.httpurl};g&&(-1===t?b(T({},g,{"view_images":[].concat(_toConsumableArray(g.view_images),[n])})):(g.view_images[t]=n,b(T({},g))))})},"userDelImg":function userDelImg(e){if(g){var n=JSON.parse(JSON.stringify(g));n.view_images.splice(e,1),b(n)}}},p,y),Object.assign(this.__state,{"model":g,"$compid__30":a,"$compid__31":f,"$compid__32":p,"showProfession":F,"areaInfo":_,"phone":O,"showUpload":w,"text":R}),this.__state}},{"key":"anonymousFunc0","value":function anonymousFunc0(){}},{"key":"anonymousFunc1","value":function anonymousFunc1(){}},{"key":"anonymousFunc2","value":function anonymousFunc2(){}},{"key":"anonymousFunc3","value":function anonymousFunc3(){}},{"key":"anonymousFunc4","value":function anonymousFunc4(){}},{"key":"anonymousFunc5","value":function anonymousFunc5(){}},{"key":"anonymousFunc6","value":function anonymousFunc6(){}},{"key":"anonymousFunc7","value":function anonymousFunc7(){}},{"key":"anonymousFunc8","value":function anonymousFunc8(){}},{"key":"anonymousFunc9","value":function anonymousFunc9(){}},{"key":"anonymousFunc10","value":function anonymousFunc10(){}}]),PublishRecruit);function PublishRecruit(){!function _classCallCheck(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}(this,PublishRecruit);var e=function _possibleConstructorReturn(e,n){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!n||"object"!=typeof n&&"function"!=typeof n?e:n}(this,(PublishRecruit.__proto__||Object.getPrototypeOf(PublishRecruit)).apply(this,arguments));return e.config={"navigationBarTitleText":"发布招工","navigationBarBackgroundColor":"#0099ff","navigationBarTextStyle":"white","backgroundTextStyle":"dark"},e.$usedState=["model","$compid__30","$compid__31","$compid__32","showProfession","areaInfo","phone","showUpload","text"],e.customComponents=["Auth","Profession","WordsTotal","ImageView"],e}i.$$events=["anonymousFunc1","anonymousFunc2","anonymousFunc3","anonymousFunc4","anonymousFunc5","anonymousFunc6","anonymousFunc7","anonymousFunc8","anonymousFunc9","anonymousFunc10"],i.$$componentPath="pages/recruit/publish/index",i.config={"navigationBarTitleText":"发布招工","navigationBarBackgroundColor":"#0099ff","navigationBarTextStyle":"white","backgroundTextStyle":"dark"},n.default=i,Page(t(0).default.createComponent(i,!0))}},[[99,0,1]]]);